<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 11 Outliers, high leverage &amp; influential points | STAT462 Lab Book 2024</title>
<meta name="author" content="Dr Helen Greatrex">
<meta name="description" content="11.1 What are they There are three key things to know when it comes to outliers: An “outlier” We use the word outlier to describe an observation (point on the scatterplot) that has a very...">
<meta name="generator" content="bookdown 0.37 with bs4_book()">
<meta property="og:title" content="Chapter 11 Outliers, high leverage &amp; influential points | STAT462 Lab Book 2024">
<meta property="og:type" content="book">
<meta property="og:description" content="11.1 What are they There are three key things to know when it comes to outliers: An “outlier” We use the word outlier to describe an observation (point on the scatterplot) that has a very...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 11 Outliers, high leverage &amp; influential points | STAT462 Lab Book 2024">
<meta name="twitter:description" content="11.1 What are they There are three key things to know when it comes to outliers: An “outlier” We use the word outlier to describe an observation (point on the scatterplot) that has a very...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.6.1/transition.js"></script><script src="libs/bs3compat-0.6.1/tabs.js"></script><script src="libs/bs3compat-0.6.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/vembedr-0.1.5/css/vembedr.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="libs/plotly-binding-4.10.3/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">STAT462 Lab Book 2024</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome to STAT-462!</a></li>
<li><a class="" href="FAQ.html">Course FAQ</a></li>
<li><a class="" href="WhatIsR.html">What are R and R-Studio?</a></li>
<li><a class="" href="Setup_Desktop.html">Installing R/R-Studio</a></li>
<li><a class="" href="Setup_UpdateDesktop.html">Updating R/R-Studio</a></li>
<li><a class="" href="Setup_Online.html">Posit Cloud Online</a></li>
<li class="book-part">.</li>
<li class="book-part">LAB INSTRUCTIONS</li>
<li><a class="" href="Help.html">HELP!</a></li>
<li><a class="" href="Lab_1.html">Lab 1</a></li>
<li><a class="" href="Lab_2.html">Lab 2</a></li>
<li><a class="" href="Lab_3.html">Lab 3</a></li>
<li><a class="" href="Lab_4.html">Lab 4</a></li>
<li><a class="" href="Lab_5.html">Lab 5A</a></li>
<li><a class="" href="Lab_5B.html">Lab 5B</a></li>
<li class="book-part">.</li>
<li class="book-part">TUTORIALS</li>
<li><a class="" href="T1_Projects.html"><span class="header-section-number">1</span> Projects/Starting a lab</a></li>
<li><a class="" href="T2_Libraries.html"><span class="header-section-number">2</span> Libraries/Packages</a></li>
<li><a class="" href="T3_Markdown.html"><span class="header-section-number">3</span> R-Markdown</a></li>
<li><a class="" href="T4_ReadingData.html"><span class="header-section-number">4</span> Reading in data</a></li>
<li><a class="" href="probability-distributions.html"><span class="header-section-number">5</span> Probability distributions</a></li>
<li><a class="" href="T6_plots.html"><span class="header-section-number">6</span> Plots</a></li>
<li><a class="" href="correlation.html"><span class="header-section-number">7</span> Correlation</a></li>
<li><a class="" href="T8_regression.html"><span class="header-section-number">8</span> Regression</a></li>
<li><a class="" href="T9_wrangling.html"><span class="header-section-number">9</span> Data Wrangling</a></li>
<li><a class="" href="T10_diagnostics.html"><span class="header-section-number">10</span> Assessing LINE</a></li>
<li><a class="active" href="outliers-high-leverage-influential-points.html"><span class="header-section-number">11</span> Outliers, high leverage &amp; influential points</a></li>
<li><a class="" href="confidence-and-prediction-intervals.html"><span class="header-section-number">12</span> Confidence and Prediction Intervals</a></li>
<li><a class="" href="S.Tutorial_Transformations.html"><span class="header-section-number">13</span> Transformations</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="outliers-high-leverage-influential-points" class="section level1" number="11">
<h1>
<span class="header-section-number">11</span> Outliers, high leverage &amp; influential points<a class="anchor" aria-label="anchor" href="#outliers-high-leverage-influential-points"><i class="fas fa-link"></i></a>
</h1>
<div id="what-are-they" class="section level2" number="11.1">
<h2>
<span class="header-section-number">11.1</span> What are they<a class="anchor" aria-label="anchor" href="#what-are-they"><i class="fas fa-link"></i></a>
</h2>
<p>There are three key things to know when it comes to outliers:</p>
<div id="an-outlier" class="section level3 unnumbered">
<h3>An “outlier”<a class="anchor" aria-label="anchor" href="#an-outlier"><i class="fas fa-link"></i></a>
</h3>
<p>We use the word <strong>outlier</strong> to describe an observation (point on the scatterplot) that has a very different response from the predicted response from the model. E.g. it has a large residual.</p>
<p><br></p>
</div>
<div id="a-high-leverage-point" class="section level3 unnumbered">
<h3>A high leverage point<a class="anchor" aria-label="anchor" href="#a-high-leverage-point"><i class="fas fa-link"></i></a>
</h3>
<p>If a data point has an x-value that is extremely different (either too high or too low) from the rest of the data points, we call this a <strong>high leverage</strong> point. It might, or might not be an outlier.</p>
<p><br></p>
</div>
<div id="an-influential-point" class="section level3 unnumbered">
<h3>An influential point<a class="anchor" aria-label="anchor" href="#an-influential-point"><i class="fas fa-link"></i></a>
</h3>
<p>We call a data point an <strong>influential point</strong> if that data point has a considerable impact on the regression model. It likely has an unusual X AND an unusual residual. For instance, if the model fit changes considerably by removing a point, such data point is called an influential point. Influential points tend to be further from the mean.</p>
<p><br><br></p>
<details></details>
</div>
</div>
<div id="how-to-find-them" class="section level2" number="11.2">
<h2>
<span class="header-section-number">11.2</span> How to find them<a class="anchor" aria-label="anchor" href="#how-to-find-them"><i class="fas fa-link"></i></a>
</h2>
<p>We can identify residuals via “residual vs leverage plots” and by looking at the ‘cooks distance’ for influential points.</p>
<div id="residual-vs-leverage-plots" class="section level3" number="11.2.1">
<h3>
<span class="header-section-number">11.2.1</span> Residual vs leverage plots<a class="anchor" aria-label="anchor" href="#residual-vs-leverage-plots"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb234"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_resid_lev.html">ols_plot_resid_lev</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="in_04-Tutorial11_Outliers_files/figure-html/unnamed-chunk-2-1.png" width="672"></div>
<p>This takes all</p>
</div>
</div>
<div id="examples" class="section level2" number="11.3">
<h2>
<span class="header-section-number">11.3</span> Examples<a class="anchor" aria-label="anchor" href="#examples"><i class="fas fa-link"></i></a>
</h2>
<div id="no-outliers-influential-or-high-leverage-points" class="section level3 unnumbered">
<h3>No outliers, influential or high leverage points<a class="anchor" aria-label="anchor" href="#no-outliers-influential-or-high-leverage-points"><i class="fas fa-link"></i></a>
</h3>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-3"></span>
<img src="in_04-Tutorial11_Outliers_files/figure-html/unnamed-chunk-3-1.png" alt="No outliers, influential values or high leverage points" width="672"><p class="caption">
Figure 11.1: No outliers, influential values or high leverage points
</p>
</div>

</div>
</div>
<div id="how-to-find-them-1" class="section level2" number="11.4">
<h2>
<span class="header-section-number">11.4</span> How to find them<a class="anchor" aria-label="anchor" href="#how-to-find-them-1"><i class="fas fa-link"></i></a>
</h2>
<div id="assessing-outliers-via-visual-inspection" class="section level3" number="11.4.1">
<h3>
<span class="header-section-number">11.4.1</span> Assessing outliers via visual inspection<a class="anchor" aria-label="anchor" href="#assessing-outliers-via-visual-inspection"><i class="fas fa-link"></i></a>
</h3>
<p>The first way we can check for simple linear regression is to plot the data and take a look. Here are some examples that we can assess by eye which show the different effects.</p>
<p><br></p>
</div>
<div id="no-outliers-influential-or-high-leverage-points-1" class="section level3 unnumbered">
<h3>No outliers, influential or high leverage points<a class="anchor" aria-label="anchor" href="#no-outliers-influential-or-high-leverage-points-1"><i class="fas fa-link"></i></a>
</h3>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-4"></span>
<img src="in_04-Tutorial11_Outliers_files/figure-html/unnamed-chunk-4-1.png" alt="No outliers, influential values or high leverage points" width="672"><p class="caption">
Figure 11.2: No outliers, influential values or high leverage points
</p>
</div>
<p>In the figure above, all of the data points follow the general trend of the rest of the data, so there are no outliers (in the y direction). And, none of the data points are extreme with respect to x, so there are no high leverage points. Overall, none of the data points would appear to be influential with respect to the location of the best fitting line. e.g. if we removed any one point, the line would probably be the same.</p>
<p><br></p>
</div>
<div id="an-outlier-with-no-leverage" class="section level3 unnumbered">
<h3>An outlier with no leverage<a class="anchor" aria-label="anchor" href="#an-outlier-with-no-leverage"><i class="fas fa-link"></i></a>
</h3>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-5"></span>
<img src="in_04-Tutorial11_Outliers_files/figure-html/unnamed-chunk-5-1.png" alt="One outlier. The red-dashed line is the model including all the points. The black-solid line is the model with the red point removed " width="672"><p class="caption">
Figure 0.1: One outlier. The red-dashed line is the model including all the points. The black-solid line is the model with the red point removed
</p>
</div>
<p>In the figure above, most of the data points follow the general trend of the rest of the data, but there is one clear outlier (one point that is unusual in the y direction). However, no point has an extreme x value, so there are no high leverage points. Overall, none of the data points would appear to be influential with respect to the location of the best fitting line. e.g.when we removed the red point,the line of best fit remains relatively stable.</p>
<p><br></p>
</div>
<div id="a-high-leverage-point-that-isnt-an-outlier" class="section level3 unnumbered">
<h3>A high leverage point that isn’t an outlier<a class="anchor" aria-label="anchor" href="#a-high-leverage-point-that-isnt-an-outlier"><i class="fas fa-link"></i></a>
</h3>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-6"></span>
<img src="in_04-Tutorial11_Outliers_files/figure-html/unnamed-chunk-6-1.png" alt="No outliers,but one high leverage point. The red-dashed line is the model including all the points. The black-solid line is the model with the red point removed" width="672"><p class="caption">
Figure 10.1: No outliers,but one high leverage point. The red-dashed line is the model including all the points. The black-solid line is the model with the red point removed
</p>
</div>
<p>In the figure above, most of the data points follow the general trend of the rest of the data, so there are no outliers (in the y direction). But one data points is extreme with respect to x. Overall, none of the data points would appear to be influential with respect to the location of the best fitting line. e.g.when we removed the red point,the line of best fit remained relatively stable.</p>
<p><br></p>
</div>
<div id="an-influential-high-leverage-outlier" class="section level3 unnumbered">
<h3>An influential high leverage outlier<a class="anchor" aria-label="anchor" href="#an-influential-high-leverage-outlier"><i class="fas fa-link"></i></a>
</h3>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-7"></span>
<img src="in_04-Tutorial11_Outliers_files/figure-html/unnamed-chunk-7-1.png" alt="One influential high leverage outlier. The red-dashed line is the model including all the points. The black-solid line is the model with the red point removed" width="672"><p class="caption">
Figure 10.2: One influential high leverage outlier. The red-dashed line is the model including all the points. The black-solid line is the model with the red point removed
</p>
</div>
<p>In the figure above, most of the data points follow the general trend of the rest of the data, with one clear outlier. This point also has high leverage abd appears to be very influential. e.g.when we removed the red point,the line of best fit changes hugely,</p>
<p>Here with a simple regression, we can easily see outliers. This is much harder when we have many predictors. So as well as examining the data by eye, we can use diagnostic plots.</p>
</div>
<div id="detecting-outliers-via-plots" class="section level3" number="11.4.2">
<h3>
<span class="header-section-number">11.4.2</span> Detecting outliers via plots<a class="anchor" aria-label="anchor" href="#detecting-outliers-via-plots"><i class="fas fa-link"></i></a>
</h3>
<p>In lab 5, we mentioned two measures that we use to help identify outliers. They are:</p>
<ul>
<li>Residuals</li>
<li>Studentized residuals (or internally studentized residuals) (often called standardized residuals)</li>
</ul>
<p>First, briefly review these measures using this page: <a href="https://online.stat.psu.edu/stat501/lesson/11/11.3" class="uri">https://online.stat.psu.edu/stat501/lesson/11/11.3</a></p>
<p>OLSRR also offers several more plots and tests including :</p>
<ul>
<li>Cook’s D Bar Plot</li>
<li>Cook’s D Chart</li>
<li>DFBETAs Panel</li>
<li>DFFITs Plot</li>
<li>Studentized Residual Plot</li>
<li>Standardized Residual Chart</li>
<li>Studentized Residuals vs Leverage Plot</li>
<li>Deleted Studentized Residual vs Fitted Values Plot</li>
<li>Hadi Plot</li>
<li>Potential Residual Plot</li>
</ul>
<p>For now, we will focus on one of the most effective ways to assess residuals, the studentized residual/fits plot.</p>
<p>For example for our test data:</p>
<div class="sourceCode" id="cb235"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read the data</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"neither.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#calculate the model</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">x</span>,data<span class="op">=</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="va">leverage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_leverage.html">ols_leverage</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># plot 1 (left hand side)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">x</span>,<span class="va">data</span><span class="op">$</span><span class="va">y</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">"x"</span>,ylab<span class="op">=</span><span class="st">"y"</span>,main<span class="op">=</span><span class="st">"Dataset C"</span><span class="op">)</span>; </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="in_04-Tutorial11_Outliers_files/figure-html/unnamed-chunk-8-1.png" width="672"></div>
<div class="sourceCode" id="cb236"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot 2 (right hand side). Remember to choose your own ylim</span></span>
<span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_resid_stud.html">ols_plot_resid_stud</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="in_04-Tutorial11_Outliers_files/figure-html/unnamed-chunk-8-2.png" width="672"></div>
<p>There should be no absolute cut-off here (around 2-3 is a warning sign). Instead, take these as an opportunity to explore those points further. For example here is our plot with the residual:</p>
<div class="sourceCode" id="cb237"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read the data</span></span>
<span><span class="va">data1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"outlier.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#calculate the model</span></span>
<span><span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">x</span>,data<span class="op">=</span><span class="va">data1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot 1 (left hand side)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">data1</span><span class="op">$</span><span class="va">x</span>,<span class="va">data1</span><span class="op">$</span><span class="va">y</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">"x"</span>,ylab<span class="op">=</span><span class="st">"y"</span>,main<span class="op">=</span><span class="st">"Dataset B"</span><span class="op">)</span>; </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="va">model1</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="in_04-Tutorial11_Outliers_files/figure-html/unnamed-chunk-9-1.png" width="672"></div>
<div class="sourceCode" id="cb238"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot 2 (right hand side). Remember to choose your own ylim</span></span>
<span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_resid_stand.html">ols_plot_resid_stand</a></span><span class="op">(</span><span class="va">model1</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="in_04-Tutorial11_Outliers_files/figure-html/unnamed-chunk-9-2.png" width="672"></div>
<p>Here the plot is telling me that it thinks row 21 of the dataset might be an outlier</p>
<div class="sourceCode" id="cb239"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data1</span><span class="op">[</span><span class="fl">21</span>,<span class="op">]</span></span></code></pre></div>
<pre><code>##    x  y
## 21 4 40</code></pre>
<p><br><br></p>
</div>
<div id="detecting-influential-points" class="section level3" number="11.4.3">
<h3>
<span class="header-section-number">11.4.3</span> Detecting influential points<a class="anchor" aria-label="anchor" href="#detecting-influential-points"><i class="fas fa-link"></i></a>
</h3>
<p>If a point is both an outlier AND has leverage, chances are it will be influential over the fit. OLSRR has a nice way of summarising both statistics.</p>
<p>For example here are our four plots together:</p>
<div class="sourceCode" id="cb241"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read the data</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"neither.csv"</span><span class="op">)</span></span>
<span><span class="va">data2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"outlier.csv"</span><span class="op">)</span></span>
<span><span class="va">data2b</span> <span class="op">&lt;-</span> <span class="va">data2</span><span class="op">[</span><span class="op">-</span><span class="fl">21</span>,<span class="op">]</span></span>
<span><span class="va">data3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"leverage.csv"</span><span class="op">)</span></span>
<span><span class="va">data3b</span> <span class="op">&lt;-</span> <span class="va">data3</span><span class="op">[</span><span class="op">-</span><span class="fl">25</span>,<span class="op">]</span></span>
<span><span class="va">data4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"influential.csv"</span><span class="op">)</span></span>
<span><span class="va">data4b</span> <span class="op">&lt;-</span> <span class="va">data4</span><span class="op">[</span><span class="op">-</span><span class="fl">25</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co">#calculate the model</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">x</span>,data<span class="op">=</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="va">model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">x</span>,data<span class="op">=</span><span class="va">data2</span><span class="op">)</span></span>
<span><span class="va">model3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">x</span>,data<span class="op">=</span><span class="va">data3</span><span class="op">)</span></span>
<span><span class="va">model4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">x</span>,data<span class="op">=</span><span class="va">data4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set up 4 sub-plots one next to each other</span></span>
<span><span class="fu">layout</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">x</span>,<span class="va">data</span><span class="op">$</span><span class="va">y</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">"x"</span>,ylab<span class="op">=</span><span class="st">"y"</span>,main<span class="op">=</span><span class="st">"Dataset A"</span>,col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">data2</span><span class="op">$</span><span class="va">x</span>,<span class="va">data2</span><span class="op">$</span><span class="va">y</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">"x"</span>,ylab<span class="op">=</span><span class="st">"y"</span>,main<span class="op">=</span><span class="st">"Dataset B"</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">data2b</span><span class="op">$</span><span class="va">x</span>,<span class="va">data2b</span><span class="op">$</span><span class="va">y</span>,pch<span class="op">=</span><span class="fl">16</span>,type<span class="op">=</span><span class="st">"p"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="va">model2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">data3</span><span class="op">$</span><span class="va">x</span>,<span class="va">data3</span><span class="op">$</span><span class="va">y</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">"x"</span>,ylab<span class="op">=</span><span class="st">"y"</span>,main<span class="op">=</span><span class="st">"Dataset C"</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">data3b</span><span class="op">$</span><span class="va">x</span>,<span class="va">data3b</span><span class="op">$</span><span class="va">y</span>,pch<span class="op">=</span><span class="fl">16</span>,type<span class="op">=</span><span class="st">"p"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="va">model3</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">data4</span><span class="op">$</span><span class="va">x</span>,<span class="va">data4</span><span class="op">$</span><span class="va">y</span>,pch<span class="op">=</span><span class="fl">16</span>,xlab<span class="op">=</span><span class="st">"x"</span>,ylab<span class="op">=</span><span class="st">"y"</span>,main<span class="op">=</span><span class="st">"Dataset D"</span>,col<span class="op">=</span><span class="st">"red"</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">data4b</span><span class="op">$</span><span class="va">x</span>,<span class="va">data4b</span><span class="op">$</span><span class="va">y</span>,pch<span class="op">=</span><span class="fl">16</span>,type<span class="op">=</span><span class="st">"p"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="va">model4</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-11"></span>
<img src="in_04-Tutorial11_Outliers_files/figure-html/unnamed-chunk-11-1.png" alt="Our four examples" width="672"><p class="caption">
Figure 11.3: Our four examples
</p>
</div>
<p>and here are the OLSRR summary plots for each.</p>
<ul>
<li><p>On the x-axis, you can see how high the leverage is. E.g. if it’s on the left it’s close to the mean x, if it’s on the right it’s far from the mean AKA it’s high leverage</p></li>
<li><p>On the y-axis, you can see the normalised residual value AKA how big is the residual, but plotted in terms of standard deviations away from the mean of y.</p></li>
</ul>
<p>Compare plots 1,2,3 and 4 with the scatterplots above. See if you can identify which is which.</p>
<div class="sourceCode" id="cb242"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># model A</span></span>
<span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_resid_lev.html">ols_plot_resid_lev</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="in_04-Tutorial11_Outliers_files/figure-html/unnamed-chunk-12-1.png" width="672"></div>
<div class="sourceCode" id="cb243"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># model B</span></span>
<span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_resid_lev.html">ols_plot_resid_lev</a></span><span class="op">(</span><span class="va">model2</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="in_04-Tutorial11_Outliers_files/figure-html/unnamed-chunk-12-2.png" width="672"></div>
<div class="sourceCode" id="cb244"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># model C</span></span>
<span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_resid_lev.html">ols_plot_resid_lev</a></span><span class="op">(</span><span class="va">model3</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="in_04-Tutorial11_Outliers_files/figure-html/unnamed-chunk-12-3.png" width="672"></div>
<div class="sourceCode" id="cb245"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># model D</span></span>
<span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_resid_lev.html">ols_plot_resid_lev</a></span><span class="op">(</span><span class="va">model4</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="in_04-Tutorial11_Outliers_files/figure-html/unnamed-chunk-12-4.png" width="672"></div>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="T10_diagnostics.html"><span class="header-section-number">10</span> Assessing LINE</a></div>
<div class="next"><a href="confidence-and-prediction-intervals.html"><span class="header-section-number">12</span> Confidence and Prediction Intervals</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#outliers-high-leverage-influential-points"><span class="header-section-number">11</span> Outliers, high leverage &amp; influential points</a></li>
<li>
<a class="nav-link" href="#what-are-they"><span class="header-section-number">11.1</span> What are they</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#an-outlier">An “outlier”</a></li>
<li><a class="nav-link" href="#a-high-leverage-point">A high leverage point</a></li>
<li><a class="nav-link" href="#an-influential-point">An influential point</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#how-to-find-them"><span class="header-section-number">11.2</span> How to find them</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#residual-vs-leverage-plots"><span class="header-section-number">11.2.1</span> Residual vs leverage plots</a></li></ul>
</li>
<li>
<a class="nav-link" href="#examples"><span class="header-section-number">11.3</span> Examples</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#no-outliers-influential-or-high-leverage-points">No outliers, influential or high leverage points</a></li></ul>
</li>
<li>
<a class="nav-link" href="#how-to-find-them-1"><span class="header-section-number">11.4</span> How to find them</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#assessing-outliers-via-visual-inspection"><span class="header-section-number">11.4.1</span> Assessing outliers via visual inspection</a></li>
<li><a class="nav-link" href="#no-outliers-influential-or-high-leverage-points-1">No outliers, influential or high leverage points</a></li>
<li><a class="nav-link" href="#an-outlier-with-no-leverage">An outlier with no leverage</a></li>
<li><a class="nav-link" href="#a-high-leverage-point-that-isnt-an-outlier">A high leverage point that isn’t an outlier</a></li>
<li><a class="nav-link" href="#an-influential-high-leverage-outlier">An influential high leverage outlier</a></li>
<li><a class="nav-link" href="#detecting-outliers-via-plots"><span class="header-section-number">11.4.2</span> Detecting outliers via plots</a></li>
<li><a class="nav-link" href="#detecting-influential-points"><span class="header-section-number">11.4.3</span> Detecting influential points</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>STAT462 Lab Book 2024</strong>" was written by Dr Helen Greatrex. It was last built on 2024-04-01.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
